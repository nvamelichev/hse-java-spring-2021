<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1248px" preserveAspectRatio="none" style="width:996px;height:1248px;" version="1.1" viewBox="0 0 996 1248" width="996px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="69.9188" style="stroke:#A80036;stroke-width:2.4;" width="24" x="286.8" y="277.0313"/><rect fill="#FFFFFF" height="69.9188" style="stroke:#A80036;stroke-width:2.4;" width="24" x="286.8" y="626.625"/><rect fill="#FFFFFF" height="139.8375" style="stroke:#A80036;stroke-width:2.4;" width="24" x="286.8" y="867.5813"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:5.0,5.0;" x1="67.2" x2="67.2" y1="202.3125" y2="1050.6187"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:5.0,5.0;" x1="298.8" x2="298.8" y1="202.3125" y2="1050.6187"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:5.0,5.0;" x1="596.4" x2="596.4" y1="202.3125" y2="1050.6187"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:5.0,5.0;" x1="835.2" x2="835.2" y1="202.3125" y2="1050.6187"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="98.4" x="12" y="194.3883">Client</text><ellipse cx="68.4" cy="36" fill="#FEFECE" rx="19.2" ry="19.2" style="stroke:#A80036;stroke-width:4.8;"/><path d="M68.4,55.2 L68.4,120 M37.2,74.4 L99.6,74.4 M68.4,120 L37.2,156 M68.4,120 L99.6,156 " fill="none" style="stroke:#A80036;stroke-width:4.8;"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="98.4" x="12" y="1079.407">Client</text><ellipse cx="68.4" cy="1111.3313" fill="#FEFECE" rx="19.2" ry="19.2" style="stroke:#A80036;stroke-width:4.8;"/><path d="M68.4,1130.5313 L68.4,1195.3313 M37.2,1149.7313 L99.6,1149.7313 M68.4,1195.3313 L37.2,1231.3313 M68.4,1195.3313 L99.6,1231.3313 " fill="none" style="stroke:#A80036;stroke-width:4.8;"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="50.4" x="266.4" y="194.3883">DB</text><path d="M255.6,76.8 C255.6,52.8 298.8,52.8 298.8,52.8 C298.8,52.8 342,52.8 342,76.8 L342,139.2 C342,163.2 298.8,163.2 298.8,163.2 C298.8,163.2 255.6,163.2 255.6,139.2 L255.6,76.8 " fill="#FEFECE" style="stroke:#000000;stroke-width:3.5999999999999996;"/><path d="M255.6,76.8 C255.6,100.8 298.8,100.8 298.8,100.8 C298.8,100.8 342,100.8 342,76.8 " fill="none" style="stroke:#000000;stroke-width:3.5999999999999996;"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="50.4" x="266.4" y="1079.407">DB</text><path d="M255.6,1111.3313 C255.6,1087.3313 298.8,1087.3313 298.8,1087.3313 C298.8,1087.3313 342,1087.3313 342,1111.3313 L342,1173.7313 C342,1197.7313 298.8,1197.7313 298.8,1197.7313 C298.8,1197.7313 255.6,1197.7313 255.6,1173.7313 L255.6,1111.3313 " fill="#FEFECE" style="stroke:#000000;stroke-width:3.5999999999999996;"/><path d="M255.6,1111.3313 C255.6,1135.3313 298.8,1135.3313 298.8,1135.3313 C298.8,1135.3313 342,1135.3313 342,1111.3313 " fill="none" style="stroke:#000000;stroke-width:3.5999999999999996;"/><rect fill="#FEFECE" height="72.7125" style="stroke:#A80036;stroke-width:3.5999999999999996;" width="244.8" x="474" y="127.2"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="211.2" x="490.8" y="175.1883">Work Queue</text><rect fill="#FEFECE" height="72.7125" style="stroke:#A80036;stroke-width:3.5999999999999996;" width="244.8" x="474" y="1048.2188"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="211.2" x="490.8" y="1096.207">Work Queue</text><rect fill="#FEFECE" height="72.7125" style="stroke:#A80036;stroke-width:3.5999999999999996;" width="175.2" x="753.6" y="117.6"/><rect fill="#FEFECE" height="72.7125" style="stroke:#A80036;stroke-width:3.5999999999999996;" width="175.2" x="744" y="127.2"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="141.6" x="760.8" y="175.1883">Workers</text><rect fill="#FEFECE" height="72.7125" style="stroke:#A80036;stroke-width:3.5999999999999996;" width="175.2" x="753.6" y="1048.2188"/><rect fill="#FEFECE" height="72.7125" style="stroke:#A80036;stroke-width:3.5999999999999996;" width="175.2" x="744" y="1057.8188"/><text fill="#000000" font-family="sans-serif" font-size="33.6" lengthAdjust="spacing" textLength="141.6" x="760.8" y="1105.807">Workers</text><rect fill="#FFFFFF" height="69.9188" style="stroke:#A80036;stroke-width:2.4;" width="24" x="286.8" y="277.0313"/><rect fill="#FFFFFF" height="69.9188" style="stroke:#A80036;stroke-width:2.4;" width="24" x="286.8" y="626.625"/><rect fill="#FFFFFF" height="139.8375" style="stroke:#A80036;stroke-width:2.4;" width="24" x="286.8" y="867.5813"/><polygon fill="#A80036" points="258,267.4313,282,277.0313,258,286.6312,267.6,277.0313" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;" x1="68.4" x2="272.4" y1="277.0313" y2="277.0313"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="151.2" x="85.2" y="264.873">save task</text><polygon fill="#A80036" points="94.8,337.35,70.8,346.95,94.8,356.55,85.2,346.95" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:2.0,2.0;" x1="80.4" x2="296.4" y1="346.95" y2="346.95"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="160.8" x="109.2" y="334.7918">tx commit</text><polygon fill="#A80036" points="325.2,407.2688,301.2,416.8688,325.2,426.4688,315.6,416.8688" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;" x1="310.8" x2="594" y1="416.8688" y2="416.8688"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="57.6" x="339.6" y="404.7105">poll</text><polygon fill="#A80036" points="567.6,477.1875,591.6,486.7875,567.6,496.3875,577.2,486.7875" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:2.0,2.0;" x1="298.8" x2="582" y1="486.7875" y2="486.7875"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="240" x="315.6" y="474.6293">new task found</text><polygon fill="#A80036" points="807.6,547.1062,831.6,556.7063,807.6,566.3063,817.2,556.7063" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;" x1="596.4" x2="822" y1="556.7063" y2="556.7063"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="182.4" x="613.2" y="544.548">start thread</text><polygon fill="#A80036" points="337.2,617.025,313.2,626.625,337.2,636.225,327.6,626.625" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;" x1="322.8" x2="834" y1="626.625" y2="626.625"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="278.4" x="351.6" y="614.4668">mark task started</text><polygon fill="#A80036" points="807.6,686.9438,831.6,696.5437,807.6,706.1438,817.2,696.5437" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:2.0,2.0;" x1="298.8" x2="822" y1="696.5437" y2="696.5437"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="160.8" x="315.6" y="684.3855">tx commit</text><line style="stroke:#A80036;stroke-width:2.4;" x1="836.4" x2="937.2" y1="766.4625" y2="766.4625"/><line style="stroke:#A80036;stroke-width:2.4;" x1="937.2" x2="937.2" y1="766.4625" y2="797.6625"/><line style="stroke:#A80036;stroke-width:2.4;" x1="838.8" x2="937.2" y1="797.6625" y2="797.6625"/><polygon fill="#A80036" points="862.8,788.0625,838.8,797.6625,862.8,807.2625,853.2,797.6625" style="stroke:#A80036;stroke-width:2.4;"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="127.2" x="853.2" y="754.3043">run task</text><polygon fill="#A80036" points="337.2,857.9812,313.2,867.5813,337.2,877.1813,327.6,867.5813" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;" x1="322.8" x2="834" y1="867.5813" y2="867.5813"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="254.4" x="351.6" y="855.423">write task result</text><polygon fill="#A80036" points="337.2,927.9,313.2,937.5,337.2,947.1,327.6,937.5" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;" x1="322.8" x2="834" y1="937.5" y2="937.5"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="223.2" x="351.6" y="925.3418">complete task</text><polygon fill="#A80036" points="807.6,997.8187,831.6,1007.4187,807.6,1017.0188,817.2,1007.4187" style="stroke:#A80036;stroke-width:2.4;"/><line style="stroke:#A80036;stroke-width:2.4;stroke-dasharray:2.0,2.0;" x1="298.8" x2="822" y1="1007.4187" y2="1007.4187"/><text fill="#000000" font-family="sans-serif" font-size="31.2" lengthAdjust="spacing" textLength="160.8" x="315.6" y="995.2605">tx commit</text><!--MD5=[521457bbedc26ed2e3ad55981ca377c3]
@startuml

actor Client as C
database DB
participant "Work Queue" as Q

collections "Workers" as T

C->DB: save task
activate DB
DB- ->C: tx commit
deactivate DB

Q->DB: poll
DB- ->Q: new task found
Q->T: start thread

T->DB: mark task started
activate DB
DB- ->T: tx commit
deactivate DB

T->T: run task

T->DB: write task result
activate DB
T->DB: complete task
DB- ->T: tx commit
deactivate DB

skinparam Shadowing false

@enduml

PlantUML version 1.2021.01(Tue Feb 02 10:55:08 MSK 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>